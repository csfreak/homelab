apiVersion: monitoring.coreos.com/v1
kind: PodMonitor
metadata:
  name: snmp-metrics
spec:
  namespaceSelector:
    matchNames:
      - monitoring
  selector:
    matchLabels:
      app: snmp-exporter
  podMetricsEndpoints:
    - port: snmp-exporter
      path: /metrics
      interval: 10s
    - interval: 30s
      params:
        module:
          - mikrotik
        target:
          - 172.31.1.2
      path: /snmp
      port: snmp-exporter
      metricRelabelings:
        - sourceLabels:
            - "__name__"
          targetLabel: "__name__"
          replacement: "snmp_value_$1"
        - targetLabel: module
          replacement: mikrotik
        - targetLabel: target
          replacement: labrouter
    - interval: 30s
      params:
        module:
          - mikrotik
        target:
          - 172.31.1.1
      path: /snmp
      port: snmp-exporter
      metricRelabelings:
        - sourceLabels:
            - "__name__"
          targetLabel: "__name__"
          replacement: "snmp_value_$1"
        - targetLabel: module
          replacement: mikrotik
        - targetLabel: target
          replacement: corerouter
    - interval: 30s
      params:
        module:
          - ruckus_unleashed
        target:
          - 192.168.2.2
      path: /snmp
      port: snmp-exporter
      metricRelabelings:
        - sourceLabels:
            - "__name__"
          targetLabel: "__name__"
          replacement: "snmp_value_$1"
        - targetLabel: module
          replacement: ruckus_unleashed
        - targetLabel: target
          replacement: homewireless
    - interval: 30s
      params:
        module:
          - synology
        target:
          - 172.31.1.194
      path: /snmp
      port: snmp-exporter
      metricRelabelings:
        - sourceLabels:
            - "__name__"
          targetLabel: "__name__"
          replacement: "snmp_value_$1"
        - targetLabel: module
          replacement: synology
        - targetLabel: target
          replacement: CSfreakSAN
